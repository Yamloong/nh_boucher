<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title></title>
    <!-- SBGrid3.0 Import Lib start-->
    <script src="../../assets/js/SBGrid3/sbgrid3.js" type="text/javascript"></script>
    <link href="../../assets/js/SBGrid3/css/sbgrid3.css" rel="stylesheet" />
    <!-- <script type="text/javascript" src="./SBGrid3/sbgrid3.js"></script>
    <link rel="stylesheet" href="./SBGrid3/css/sbgrid3.css" /> -->
    <!-- SBGrid3.0 Import Lib end-->
  </head>

  <script>
    let datagrid;
    SBGrid3.$(document).ready(function(){
      createGrid();
    });
    
    const calcData = [
        {
            "field01": "우유",
            "field02": "강원도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "상원도 속초시 강정읍",
            "field07": "01001001",
            "field08": 1,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
        {
            "field01": "희망택시",
            "field02": "강원도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "상원도 속초시 강정읍",
            "field07": "01001001",
            "field08": 1,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
        {
            "field01": "아동급식",
            "field02": "경기도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "경기 고양시 일산동구",
            "field07": "01001001",
            "field08": 1,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
        {
            "field01": "아동급식",
            "field02": "경기도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "경기 고양시 일산동구",
            "field07": "01001002",
            "field08": 1,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
        {
            "field01": "아동급식",
            "field02": "경기도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "경기 고양시 일산동구",
            "field07": "01001003",
            "field08": 1,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
        {
            "field01": "아동급식",
            "field02": "경기도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "경기 고양시 일산동구",
            "field07": "01001004",
            "field08": 114,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
        {
            "field01": "아동급식",
            "field02": "경기도",
            "field03": "2023008",
            "field04": "3010054599711",
            "field05": "3010055632521",
            "field06": "경기 고양시 일산동구",
            "field07": "01001005",
            "field08": 1,
            "field09": 1,
            "field10": 467775481,
            "field11-1": 90,
            "field11-2": 90,
            "field11-3": 90,
            "field11-4": 90,
            "field11-5": 90,
            "field12-1": 90,
            "field12-2": 90,
            "field12-3": 90,
            "field12-4": 90,
            "field12-5": 90,
            "field13-1": 90,
            "field13-2": 90,
            "field13-3": 90,
            "field13-4": 90,
            "field13-5": 90,
        },
    ]
    
    var emptyData = [];
    var maxNumber = 0;
    
    function createGrid(){
      let dsConfig = {
        schema:{
          fields:{
            field04: {dataType: 'number'}
          }
        },
        groups: [
          { field: 'field01', isOpen: true },
          { field: 'field02', isOpen: true },
        ],
        data : calcData,
      }
    
      let gridConfig = {
        dataSource: dsConfig,
        defaultColumn: {
          format: '#,###',
          align: 'right'
        },
        container: '#SBGridArea',
        width: '100%',
        height: '572px',
        fixedRows: true, //행높이 고정
        captionHeight: 32, //헤더 행높이
        rowHeight: 28, //행높이
        hover: 'row',
        showRowNo: false,
        mergeRow: true, //열병합
        selectable: {
          selectMode: 'multi',
          rowSelect: true,
          columnSelect: true,
          cellSelect: 'cell',
        },
        resizable: {
          mode: "column",
          minWidth: 60, 
          autoFit: ["caption", "data"]
        },
        columns: [
          { field: 'field01', type:'text', caption:'바우처구분', width: 100, format:'text', align:'center', mergeRow: true,
            groupTitle: { visible: false },
            groups: [
              {
                footer: {template : '{{field01}} 소계', colSpan: 7}
              }, 
            ],
            total: {
              footer: [
                { template: '<span class="text-primary">총 합계</span>', colSpan: 7, align: 'center' },
              ],
            }
          },
          { field: 'field02', type:'text', caption:'지역', width: 80, format:'text', align:'center', mergeRow: true,
            groupTitle: { visible: false },
            groups: [
              {
                footer: {template : '[{{field02}}] {{field01}} 소계', colSpan: 6}
              }, 
            ],
          },
          { field: 'field03', type:'text', caption:'대상월', width: 70, format:'text', align: 'center'},
          { field: 'field04', type:'text', caption:'출금계좌', width: 110, format:'text', align: 'center'},
          { field: 'field05', type:'text', caption:'수수료계좌', width: 110, format:'text', align: 'center'},
          { field: 'field06', type:'text', caption:'지자체명', width: 160, format:'text', align: 'center'},
          { field: 'field07', type:'text', caption:'지자체코드', width: 70, format:'text', align: 'center'},
          { field: 'field08', type:'number', caption:'전체건수', width: 70,
            groups: [
              {
                group: "field01",
                aggregates: [{ func: "sum" }],
                footer: { format: '#,###'}
              },
              {
                group: "field02",
                aggregates: [{ func: "sum" }],
                footer: { format: '#,###'}
              },
            ],
            total: {
              aggregates: [
                { func: 'sum', require: 'field08', field: 'field08_total' }
              ],
              footer: [
                { 
                  template: '{{fie }}',format: '#,###',
                },
              ],
            }
          },
          { field: 'field09', type:'number', caption:'사용인원', width: 70,
            groups: [
              {
                group: "field01",
                aggregates: [{ func: "sum" }],
                footer: { format: '#,###'}
              },
              {
                group: "field02",
                aggregates: [{ func: "sum" }],
                footer: { format: '#,###'}
              },
            ],
            total: {
              aggregates: [
                { func: 'sum', require: 'field09', field: 'field09_total' }
              ],
              footer: [
                { 
                  template: '{{fie }}',format: '#,###',
                },
              ],
            }
          },
          { field: 'field10', type:'number', caption:'승인금액 총액', width: 107,
            groups: [
              {
                group: "field01",
                aggregates: [{ func: "sum" }],
                footer: { format: '#,###'}
              },
              {
                group: "field02",
                aggregates: [{ func: "sum" }],
                footer: { format: '#,###'}
              },
            ],
            total: {
              aggregates: [
                { func: 'sum', require: 'field10', field: 'field10_total' }
              ],
              footer: [
                { 
                  template: '{{fie }}',format: '#,###',
                },
              ],
            }
          },
          { caption:'합계', columns: [
            { field: 'field11-1', caption:'승인수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field11-1', field: 'field11-1_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -1_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field11-2', caption:'수수료총액', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field11-2', field: 'field11-2_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -2_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field11-3', caption:'영업점수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field11-3', field: 'field11-3_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -3_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field11-4', caption:'농협보존금', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field11-4', field: 'field11-4_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -4_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field11-5', caption:'추가수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field11-5', field: 'field11-5_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -5_total}}', format: '#,###'
                  },
                ],
              }
            },
          ]},
          { caption:'900억 이전 매출분', columns: [
            { field: 'field12-1', caption:'승인수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field12-1', field: 'field12-1_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -1_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field12-2', caption:'수수료총액', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field12-2', field: 'field12-2_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -2_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field12-3', caption:'영업점수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field12-3', field: 'field12-3_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -3_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field12-4', caption:'농협보존금', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field12-4', field: 'field12-4_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -4_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field12-5', caption:'추가수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field12-5', field: 'field12-5_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -5_total}}', format: '#,###'
                  },
                ],
              }
            },
          ]},
          { caption:'900억 이후 매출분', columns: [
            { field: 'field13-1', caption:'승인수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field13-1', field: 'field13-1_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -1_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field13-2', caption:'수수료총액', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field13-2', field: 'field13-2_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -2_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field13-3', caption:'영업점수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field13-3', field: 'field13-3_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -3_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field13-4', caption:'농협보존금', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field13-4', field: 'field13-4_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -4_total}}', format: '#,###'
                  },
                ],
              }
            },
            { field: 'field13-5', caption:'추가수수료', type: 'number', width: 80,
              groups: [
                {
                  group: "field01",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
                {
                  group: "field02",
                  aggregates: [{ func: "sum" }],
                  footer: { format: '#,###'}
                },
              ],
              total: {
                aggregates: [
                  { func: 'sum', require: 'field13-5', field: 'field13-5_total' }
                ],
                footer: [
                  { 
                    template: '{{fi -5_total}}', format: '#,###'
                  },
                ],
              }
            },
          ]}
        ],
      };
      datagrid = SBGrid3.createGrid(gridConfig);
      datagrid.refresh();
    }
  </script>
  <body>
    <div id="SBGridArea"></div>
  </body>
</html>
