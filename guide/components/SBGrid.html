<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>SBGrid</title>

<!--v Packages -->
<script src="../../assets/js/jquery.min.js"></script>

<link href="../../assets/css/jquery-ui.min.css" rel="stylesheet" />
<script src="../../assets/js/jquery-ui.min.js"></script>

<link href="../../assets/css/select2.min.css" rel="stylesheet" />
<script src="../../assets/js/select2.min.js"></script>

<!-- GUIDE관련 소스 -->
<link href="../assets/css/only_for_guide.css" rel="stylesheet" />
<script src="../assets/js/only_for_guide.js"></script>

<!--v codemirror : 소스보기용 -->
<link href="../assets/js/codemirror/lib/codemirror.css" rel="stylesheet" />
<link href="../assets/js/codemirror/theme/rubyblue.css" rel="stylesheet" />
<script src="../assets/js/codemirror/lib/codemirror.js"></script>
<script src="../assets/js/codemirror/mode/xml/xml.js"></script>
<script src="../assets/js/codemirror/mode/javascript/javascript.js"></script>
<script src="../assets/js/codemirror/mode/htmlmixed/htmlmixed.js"></script>
<script src="../assets/js/codemirror/addon/selection/active-line.js"></script>
<!--^ codemirror : 소스보기용 -->

<link href="../../assets/css/all.css" rel="stylesheet" />
<script src="../../assets/js/util.js"></script>

<script src="../../assets/js/SBGrid3/sbgrid3.js" type="text/javascript"></script>
<link href="../../assets/js/SBGrid3/css/sbgrid3.css" rel="stylesheet" />

<script>
let datagrid;
SBGrid3.$(document).ready(function(){
	createGrid();
});

const calcData = [
    {
        "text": "매화반",
        "name": "홍길동",
        "number": "1",
        "check": "T",
        "radio": "T",
        "multitext": "Never Say NO - 고객의 성공적인 프로젝트를 위해 소프트보울은 NO 보다는 YES를 지향 합니다.",
        "combo": "asia",
        "date": "2023-01-01"
    },
    {
        "text": "매화반",
        "name": "김철수",
        "number": "2",
        "check": "T",
        "radio": "F",
        "multitext": "Never Say NO \n - 고객의 성공적인 프로젝트를 위해 소프트보울은 NO 보다는 YES를 지향 합니다.",
        "combo": "asia",
        "date": "2023-01-01"
    },
    {
        "text": "매화반",
        "name": "이영희",
        "number": "3",
        "check": "",
        "radio": "S",
        "multitext": "당장 눈 앞의 이익보다는 미래에 생길 가치를, \n 나무보다는 숲을 보는 안목으로 경영하겠습니다.",
        "combo": "asia",
        "date": "2023-01-02"
    },
    {
        "text": "난초반",
        "name": "국영수",
        "number": "4",
        "check": "T",
        "radio": "F",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-03"
    },
    {
        "text": "난초반",
        "name": "영수",
        "number": "5",
        "check": "",
        "radio": "T",
        "multitext": "배가 가는 방향을 정하는 것은 바람도, 물결도 아닌 방향타를 쥔 선장의 의지입니다.",
        "combo": "asia",
        "date": "2023-01-04"
    },
    {
        "text": "난초반",
        "name": "국영",
        "number": "6",
        "check": "",
        "radio": "S",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-05"
    },
    {
        "text": "국화반",
        "name": "최민지",
        "number": "7",
        "check": "T",
        "radio": "T",
        "multitext": "당장 눈 앞의 이익보다는 미래에 생길 가치를, \n 나무보다는 숲을 보는 안목으로 경영하겠습니다.",
        "combo": "asia",
        "date": "2023-01-06"
    },
    {
        "text": "국화반",
        "name": "김갑수",
        "number": "8",
        "check": "T",
        "radio": "T",
        "multitext": "배가 가는 방향을 정하는 것은 바람도, \n 물결도 아닌 방향타를 쥔 \n 선장의 의지입니다.",
        "combo": "asia",
        "date": "2023-01-07"
    },
    {
        "text": "국화반",
        "name": "이순신",
        "number": "9",
        "check": "T",
        "radio": "T",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-08"
    },
    {
        "text": "국화반",
        "name": "임꺽정",
        "number": "10",
        "check": "",
        "radio": "S",
        "multitext": "배가 가는 방향을 정하는 것은 바람도, 물결도 아닌 방향타를 쥔 선장의 의지입니다.",
        "combo": "asia",
        "date": "2023-01-09"
    },
	{
        "text": "국화반",
        "name": "임꺽정",
        "number": "10",
        "check": "T",
        "radio": "T",
        "multitext": "Never Say NO - 고객의 성공적인 프로젝트를 위해 소프트보울은 NO 보다는 YES를 지향 합니다.",
        "combo": "asia",
        "date": "2023-01-22"
    },
    {
        "text": "국화반",
        "name": "을지문덕",
        "number": "11",
        "check": "",
        "radio": "T",
        "multitext": "Never Say NO - 고객의 성공적인 프로젝트를 위해 소프트보울은 NO 보다는 YES를 지향 합니다.",
        "combo": "asia",
        "date": "2023-01-23"
    },
    {
        "text": "국화반",
        "name": "최영",
        "number": "12",
        "check": "",
        "radio": "T",
        "multitext": "당장 눈 앞의 이익보다는 미래에 생길 가치를, \n 나무보다는 숲을 보는 안목으로 경영하겠습니다.",
        "combo": "asia",
        "date": "2023-01-24"
    },
    {
        "text": "대나무반",
        "name": "신사임당",
        "number": "13",
        "check": "T",
        "radio": "S",
        "multitext": "당장 눈 앞의 이익보다는 미래에 생길 가치를, \n 나무보다는 숲을 보는 안목으로 경영하겠습니다.",
        "combo": "asia",
        "date": "2023-01-25"
    },
    {
        "text": "매화반",
        "name": "홍길동",
        "number": "1",
        "check": "",
        "radio": "S",
        "multitext": "당장 눈 앞의 이익보다는 미래에 생길 가치를, \n 나무보다는 숲을 보는 안목으로 경영하겠습니다.",
        "combo": "asia",
        "date": "2023-01-26"
    },
    {
        "text": "매화반",
        "name": "김철수",
        "number": "2",
        "check": "",
        "radio": "T",
        "multitext": "당장 눈 앞의 이익보다는 미래에 생길 가치를, \n 나무보다는 숲을 보는 안목으로 경영하겠습니다.",
        "combo": "asia",
        "date": "2023-01-27"
    },
    {
        "text": "매화반",
        "name": "이영희",
        "number": "3",
        "check": "",
        "radio": "F",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-28"
    },
    {
        "text": "난초반",
        "name": "국영수",
        "number": "4",
        "check": "T",
        "radio": "F",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-29"
    },
    {
        "text": "난초반",
        "name": "국영수",
        "number": "4",
        "check": "T",
        "radio": "F",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-29"
    },
    {
        "text": "난초반",
        "name": "국영수",
        "number": "4",
        "check": "T",
        "radio": "F",
        "multitext": "고객만족을 통해 사회에 기여하는 기업이 되겠다는 초심을 지키며 \n 순간적인 반짝임보다는 꾸준함을 중시하는 기업이 되겠습니다.",
        "combo": "asia",
        "date": "2023-01-29"
    }
]

// 맨 우측 셀 셀렉트 박스 내용
const continentData = [
    {
        "continentValue": "asia",
        "continentText": "아시아"
    },
    {
        "continentValue": "europe",
        "continentText": "유럽"
    },
    {
        "continentValue": "north_america",
        "continentText": "북아메리카"
    },
    {
        "continentValue": "oceania",
        "continentText": "오세아니아"
    }
]

var emptyData = [];
var maxNumber = 0;

function createGrid(){
	let dsConfig = {
		schema: {},
		data : calcData,
	}

	let gridConfig = {
		dataSource: dsConfig,
		columns: [
			{ field: 'number', type:'number', caption:'숫자', width: 120,
                total: {
                    aggregates: [
                        { func: 'max' },
                        { func: 'min' },
                        { func: 'avg' },
                        { func: 'max', payload: 'name', field: 'number_name' }
                    ],
                    header: [
                        { template: '최고점 : {{number_name}} ({{max}})' }
                    ],
                    footer: [
                        { template: '합계 : {{max}}' },
                    ],
                },
            },
			{ field: 'text', type:'text', caption:'텍스트'},
			{ field: 'name', type:'text', caption:'이름' },
			{ field: 'date', type:'date', calendarType: 'date', caption:'날짜' },
			{ field: 'check', type:'check', caption:'체크박스',
				editable:true, 
				viewMode : 'checkLabel', 
				checkValue:'T', 
				checkLabel:'참가', 
				unCheckValue:'F', 
				unCheckLabel:'불참', 
				checkMode:'checkbox' ,
				directApplyEdit : true
			},
			{ field: 'radio', type:'radio',width: 180, caption:'라디오버튼',
				radioItems: [
					{ value: 'S', label: '승인' },
					{ value: 'F', label: '미승인' },
					{ value: 'T', label: '보류'},
				],
				checkMode: 'radio',
				directApplyEdit : true
			},
			{ field: 'multitext', type:'multitext', width: 350, align:"left", caption:'멀티텍스트' },
			{ field: 'button', type:'button',command : 'edit', caption:'버튼' },
			{ field: 'combo', type:'combo', caption:'콤보박스',
					viewMode : 'both',
					items : continentData,
					comboLabel : 'continentText',
					comboValue : 'continentValue',
					popupPosition : 'auto',
					width : 200
			},
		],
		container: '#SBGridArea',
        toolBar: {left:['excelImport','excel']},

        /*엑셀 업로드*/
        excelImport: {
            row: {
                from: 2,
            },
            col: {
                from: 1,
            },
        },
        
        /*엑셀 다운로드*/
        excelExport: {
        //엑셀 다운로드 시 파일명
        fileName: '엑셀 다운로드.xlsx',
        //엑셀 다운로드 시 cell에 대한 스타일 지정
        //엑셀 다운로드 시 row에 대한 스타일 지정
        rowStyle: (cssSet) => {
            if(cssSet.has('a-grade')){
                return {
                    fill: { bgColor: 'ffffff00' }
                }
            }
        },
        //엑셀 다운로드 중 esc 버튼 클릭 시 함수 실행
        cancelFunc: () => {
            alert("excel export 가 취소되었습니다");
        },

        //그리드 기본 style 설정으로 다운로드(alternateCss)
        defaultStyle:false,

        //설정된 Formula 형태로 다운로드 여부
        includeFormula: true,

        //엑셀 다운로드 시 merge 된 상태로 다운로드 여부 설정
        keepMerge: true,
        includeHeader: true,
        includeFooter:true,
        },
		width: '100%',
		height: '529px',
		fixedRows: true, //행높이 고정
		captionHeight: '32', //헤더 행높이
		rowHeight: '28', //행높이
		hover: 'row',
		selectable: {
			selectMode: 'multi',
			rowSelect: true,
			columnSelect: true,
			cellSelect: 'cell',
		},
		showSticky: true, //열고정
		checkable: true, //전체선택
		filterable: true, //필터
		sortable: true, //소트
		multiSort: true, //멀티소트
		editable:{
			mode : 'incell',       
			eventType : 'dblclick',
			immediateValidationCheck : false  // 편집 입력중 validation 체크 여부
		},
		resizable: {
            mode: "column",
            minWidth: 60, 
            autoFit: ["caption", "data"]
		}
	};
	datagrid = SBGrid3.createGrid(gridConfig);
	datagrid.refresh();
	}

    // 엑셀 다운로드
    function excelDown(){
        $('.sbgrid-tool .excel .sbgrid-excel').click();
    }

    // 엑셀 업로드
    function excelUpload(){
        $('.sbgrid-tool .excelImport .sbgrid-excel').click();
    }
</script>

</head>

<body class="guide_page">
	<header>
		<div class="inner">
			<div class="logo">UI/UX GUIDE</div>
			<ul class="gnb">
				<li><a href="../index.html">페이지</a></li>
				<li><a href="../style.html">스타일</a></li>
				<li class="active"><a href="../components.html">컴포넌트</a></li>
				<li><a href="../layouts.html">레이아웃</a></li>
				<li><a href="../about.html">About</a></li>
			</ul>
		</div>
	</header>

	<div class="guide guide_style">
		<section>
			<div class="container">
				<h2 class="page-title">SBGrid</h2>

				<div class="page-note">
					<div>SBGrid를 사용한 데이터 그리드의 예시와 사용방법입니다.</div>
					<div>Row Height (border 제외) : Header-32px / Data-28px / Footer-28px</div>
					<div>홈페이지 : <a href="https://sbgrid.co.kr" class="btn-txt" target="_new">https://sbgrid.co.kr</a></div>
				</div>

				<article class="guide">
					<h3 class="guide-title">예시</h3>

					<div class="contents">
						<ul class="info">
							<li>해당 소스는 SBGrid에 디자인을 적용하기 위한 퍼블용 소스입니다. 개발용 소스는 SBGrid에 &nbsp; <a href="https://sbgrid.co.kr/SBGridV3/api/index.html" class="btn-txt" target="_new">API문서</a> 를 참고해주세요.</li>
							<li>그리드 cell 안에서 사용할 버튼은 &nbsp; <a href="../components/button.html" class="btn-txt">컴포넌트/button.html</a> &nbsp; 가이드 파일에 명시한 그대로 넣어주시면 됩니다.</li>
							<!-- <li>본 프로젝트에서는 pagination을 사용하지 않습니다. 필요하신 경우에는 API문서를 참고해주세요.</li> -->
						</ul>

                        <div class="section-header">
                            <div class="button-wrap">
                                <button type="button" class="btn btn-line-primary" onclick="excelUpload();">
                                    <i class="icon-folder"></i>
                                    <span>파일불러오기</span>
                                </button>
                                <button type="button" class="btn btn-line-primary" onclick="excelDown();">
                                    <i class="icon-download"></i>
                                    <span>엑셀</span>
                                </button>
                            </div>
                        </div>
						<!--s 그리드가 삽입될 DIV -->
						<div id="SBGridArea"></div>
						<!--e 그리드가 삽입될 DIV -->
					</div>
					<!-- .contents -->
				</article>
			</div>
			<!-- .container -->
		</section>
	</div>
	<!-- .guide -->

	<footer>
		<div class="inner">
			<div class="copy">Copyright &copy; GRIDA 2023</div>
			<div class="f-logo"><img src="../assets/img/ci_grida.svg" /></div>
		</div>
	</footer>
</body>
</html>
